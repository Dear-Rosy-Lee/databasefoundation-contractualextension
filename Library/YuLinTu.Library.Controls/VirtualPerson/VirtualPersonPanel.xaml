<UserControl
    x:Class="YuLinTu.Library.Controls.VirtualPersonPanel"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cmps="clr-namespace:YuLinTu.Windows.Wpf.Metro.Components;assembly=YuLinTu.Windows.Wpf.Metro"
    xmlns:local="clr-namespace:YuLinTu.Library.Controls"
    xmlns:metro="clr-namespace:YuLinTu.Windows.Wpf.Metro;assembly=YuLinTu.Windows.Wpf.Metro">
    <UserControl.Resources>
        <local:ImageValueConvert x:Key="ImgConvert" />
        <local:GenderValueConvert x:Key="GenderConvert" />
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Border
            Grid.Row="0"
            Height="33"
            Padding="8,0"
            Background="{DynamicResource Metro_Window_Style_Background_Lighter}"
            BorderBrush="{DynamicResource Metro_Window_Style_BorderBrush_Default}"
            BorderThickness="0,0,0,1"
            SnapsToDevicePixels="True">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <cmps:ImageTextItem
                    Name="lbzone"
                    Grid.Column="0"
                    Image="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/管理列表16.png"
                    ImageTextSpacing="8" />
                <StackPanel
                    Name="sp_FamilyInfo"
                    Grid.Column="1"
                    VerticalAlignment="Stretch"
                    Orientation="Horizontal">
                    <cmps:Separator Orientation="Vertical" />

                    <CheckBox
                        Name="cbIsbatch"
                        Margin="8,0,8,0"
                        VerticalAlignment="Center"
                        Content="是否批量"
                        IsChecked="{Binding Path=IsBatch}" />
                    <cmps:Separator Orientation="Vertical" Visibility="{Binding ElementName=cbIsbatch, Path=Visibility}" />
                    <cmps:ImageTextItem
                        Name="lb_family"
                        MinWidth="50"
                        Margin="12,0,0,0"
                        VerticalAlignment="Center"
                        Image="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/户主16.png"
                        Text="{Binding Summary.FamilyCount}"
                        ToolTip="总户数" />
                    <cmps:ImageTextItem
                        MinWidth="60"
                        Margin="8,0,0,0"
                        VerticalAlignment="Center"
                        Image="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/FileCreateDocumentWorkspace.png"
                        Text="{Binding Summary.PersonCount}"
                        ToolTip="总人数" />
                    <cmps:ImageTextItem
                        MinWidth="60"
                        Margin="8,0,0,0"
                        VerticalAlignment="Center"
                        Image="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/男16.png"
                        Text="{Binding Summary.MaleCount}"
                        ToolTip="男性人数" />
                    <cmps:ImageTextItem
                        MinWidth="60"
                        Margin="8,0,0,0"
                        VerticalAlignment="Center"
                        Image="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/女16.png"
                        Text="{Binding Summary.FeMaleCount}"
                        ToolTip="女性人数" />
                    <cmps:ImageTextItem
                        MinWidth="50"
                        Margin="8,0,0,0"
                        VerticalAlignment="Center"
                        Image="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/户主_黑16.png"
                        Text="{Binding Summary.UnknowGenderCount}"
                        ToolTip="未知性别人数" />
                    <cmps:Separator Orientation="Vertical" />
                    <metro:MetroButton
                        Name="btn_refresh"
                        Width="30"
                        VerticalAlignment="Stretch"
                        Click="btn_refresh_Click">
                        <cmps:ImageTextItem Image="pack://application:,,,/YuLinTu.Resources;component/Images/16/Refresh.png" />
                    </metro:MetroButton>
                    <cmps:Separator Orientation="Vertical" />
                    <cmps:MetroTextBox
                        Name="txtWhere"
                        Width="130"
                        Height="25"
                        Margin="4,0,10,0"
                        TextChanged="txtWhere_TextChanged"
                        Watermask="快速过滤" />
                    <CheckBox
                        Name="cb_ComplateInfo"
                        VerticalAlignment="Center"
                        Click="cb_ComplateInfo_Click"
                        Content="全匹配" />
                </StackPanel>
            </Grid>
        </Border>
        <cmps:MetroTreeGrid
            Name="view"
            Grid.Row="1"
            cmps:DataGridAttacher.ColumnHeaderThumbWidth="1"
            cmps:DataGridAttacher.ContentBorderThickness="0,1,0,0"
            x:FieldModifier="public"
            BorderThickness="0"
            ExpandItemWhenLeftMouseDoubleClick="False"
            ItemAutoExpand="True"
            MouseDoubleClick="view_MouseDoubleClick"
            MouseRightButtonDown="view_MouseRightButtonDown"
            SelectionChanged="view_SelectionChanged">
            <cmps:MetroTreeGrid.Columns>
                <DataGridTemplateColumn
                    Width="290"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="名称"
                    SortMemberPath="Name">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <cmps:MetroTreeGridRowToggleButton />
                                <StackPanel HorizontalAlignment="Left" Orientation="Horizontal">
                                    <cmps:ImageTextItem
                                        x:Name="tbName"
                                        Margin="2,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Image="{Binding Object.Img, Converter={StaticResource ImgConvert}}"
                                        Text="{Binding Object.Name}" />
                                </StackPanel>
                            </DockPanel>
                            <DataTemplate.Triggers>
                                <DataTrigger Binding="{Binding Object.Status}" Value="1">
                                    <Setter TargetName="tbName" Property="Foreground" Value="#BF2F0B" />
                                    <Setter TargetName="tbName" Property="FontWeight" Value="Bold" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Object.OldVirtualCode}" Value="{x:Null}">
                                    <Setter TargetName="tbName" Property="Foreground" Value="#0b41bf" />
                                    <Setter TargetName="tbName" Property="FontWeight" Value="Bold" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Object.OldVirtualCode}" Value="">
                                    <Setter TargetName="tbName" Property="Foreground" Value="#0b41bf" />
                                    <Setter TargetName="tbName" Property="FontWeight" Value="Bold" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Object.Status}" Value="2">
                                    <Setter TargetName="tbName" Property="Foreground" Value="Green" />
                                </DataTrigger>
                            </DataTemplate.Triggers>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    Width="180"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="证件号码"
                    SortMemberPath="ICN">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.ICN}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    x:Name="gcAge"
                    Width="100"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="年龄"
                    SortMemberPath="Age">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.Age}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    x:Name="gcGender"
                    Width="100"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="性别"
                    SortMemberPath="Gender">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.Gender, Converter={StaticResource GenderConvert}}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    x:Name="gcRelation"
                    Width="150"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="家庭关系"
                    SortMemberPath="Relationship">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.Relationship}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    x:Name="gcEqnum"
                    Width="100"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="入股份数"
                    SortMemberPath="EquityValue">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.EquityValue}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    x:Name="gcEqArea"
                    Width="100"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="入股面积"
                    SortMemberPath="EquityArea">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.EquityArea}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    x:Name="gcPersonCount"
                    Width="72"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="承包人口"
                    SortMemberPath="ContractorNumber">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.ContractorNumber}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    x:Name="gcTotalTableArea"
                    Width="108"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="总台账面积(亩)"
                    SortMemberPath="TotalTableArea">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.TotalTableArea}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn
                    Width="330"
                    cmps:DataGridAttacher.ColumnHeaderHorizontalContentAlignment="Center"
                    Header="备注"
                    SortMemberPath="Comment">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Object.Comment}" />
                            </DockPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </cmps:MetroTreeGrid.Columns>

            <cmps:MetroTreeGrid.ContextMenu>
                <ContextMenu x:Name="aContextMenu" FontSize="13">
                    <MenuItem
                        Name="miAdd"
                        Click="miAdd_Click"
                        Header="新增承包方">
                        <MenuItem.Icon>
                            <Image
                                Height="16"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/添加户主16.png"
                                Stretch="Uniform" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        Name="miAddSharePerson"
                        Click="miAddSharePerson_Click"
                        Header="新增共有人">
                        <MenuItem.Icon>
                            <Image
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/添加书记16.png"
                                Stretch="None" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        Name="miEdit"
                        Click="miEdit_Click"
                        Header="编辑">
                        <MenuItem.Icon>
                            <Image
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/字段16.png"
                                Stretch="None" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        Name="miDel"
                        Click="miDel_Click"
                        Header="删除">
                        <MenuItem.Icon>
                            <Image
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/错误16_2.png"
                                Stretch="None" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        Name="miSet"
                        Click="miSet_Click"
                        Header="设置为户主">
                        <MenuItem.Icon>
                            <Image
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/自然人16.png"
                                Stretch="None" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        x:Name="miLock"
                        Click="miLock_Click"
                        Header="锁定/解锁承包方">
                        <MenuItem.Icon>
                            <Image
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/锁定承包方_16.png"
                                Stretch="None" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        Name="miInitall"
                        Click="miInitall_Click"
                        Header="初始数据">
                        <MenuItem.Icon>
                            <Image
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/管理列表16.png"
                                Stretch="None" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <!--<MenuItem Header="分户"
                              Name="miSplit"
                              Click="miSplit_Click">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/分割16.png"
                                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                                   SnapsToDevicePixels="True"
                                   Stretch="None" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="合户"
                              Name="miCombine"
                              Click="miCombine_Click">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/人口管理16.png"
                                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                                   SnapsToDevicePixels="True"
                                   Stretch="Uniform"
                                   Height="16" />
                        </MenuItem.Icon>
                    </MenuItem>-->

                    <MenuItem
                        Name="miNumber"
                        Click="miNumber_Click"
                        Header="户号详情">
                        <MenuItem.Icon>
                            <Image
                                Height="16"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/户号详情.png"
                                Stretch="Uniform" />
                        </MenuItem.Icon>
                    </MenuItem>

                    <MenuItem
                        Name="miClear"
                        Click="miClear_Click"
                        Header="清空">
                        <MenuItem.Icon>
                            <Image
                                Height="16"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/清空16.png"
                                Stretch="Uniform" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem
                        x:Name="setMenu"
                        Header="设置"
                        Visibility="Collapsed">
                        <MenuItem.Icon>
                            <Image
                                Height="16"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                SnapsToDevicePixels="True"
                                Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/数据库文件16.png"
                                Stretch="Uniform" />
                        </MenuItem.Icon>
                        <MenuItem
                            Name="miDataImport"
                            Click="miDataImport_Click"
                            Header="导入调查表设置"
                            Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image
                                    Height="16"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    SnapsToDevicePixels="True"
                                    Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/数据库文件16.png"
                                    Stretch="Uniform" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem
                            Name="miDataOutput"
                            Click="miDataOutput_Click"
                            Header="导出表格内容设置"
                            Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image
                                    Height="16"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    SnapsToDevicePixels="True"
                                    Source="pack://application:,,,/YuLinTu.Library.Resources;component/Resources/数据库文件16.png"
                                    Stretch="Uniform" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                </ContextMenu>
            </cmps:MetroTreeGrid.ContextMenu>

        </cmps:MetroTreeGrid>
    </Grid>
</UserControl>
